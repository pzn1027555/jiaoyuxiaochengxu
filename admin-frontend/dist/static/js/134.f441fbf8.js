"use strict";(self["webpackChunkadmin_frontend"]=self["webpackChunkadmin_frontend"]||[]).push([[134],{4134:function(e,t,r){r.r(t),r.d(t,{default:function(){return d}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"page-container"},[t("div",{staticClass:"content-box"},[t("h2",[e._v("课程轮播图管理")]),t("div",{staticClass:"toolbar"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.openDialog()}}},[e._v("新增轮播图")]),t("el-button",{attrs:{icon:"el-icon-refresh",loading:e.loading},on:{click:e.loadList}},[e._v("刷新")])],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.list,border:"",stripe:""}},[t("el-table-column",{attrs:{prop:"imageUrl",label:"封面",width:"180"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-image",{staticStyle:{width:"140px",height:"80px"},attrs:{src:e.normalizeUrl(r.row.imageUrl),fit:"cover"}})]}}])}),t("el-table-column",{attrs:{prop:"title",label:"标题","min-width":"200"}}),t("el-table-column",{attrs:{prop:"linkType",label:"跳转类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getLinkTypeText(t.row.linkType))+" ")]}}])}),t("el-table-column",{attrs:{prop:"linkValue",label:"跳转地址/路径","min-width":"220","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"sortOrder",label:"排序",width:"100"}}),t("el-table-column",{attrs:{prop:"isEnabled",label:"状态",width:"120"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-tag",{attrs:{type:1===r.row.isEnabled?"success":"info"}},[e._v(" "+e._s(1===r.row.isEnabled?"启用":"禁用")+" ")])]}}])}),t("el-table-column",{attrs:{prop:"updateTime",label:"更新时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatDate(t.row.updateTime))+" ")]}}])}),t("el-table-column",{attrs:{label:"操作",width:"200",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.openDialog(r.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(r.row)}}},[e._v("删除")])]}}])})],1),t("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"520px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{attrs:{model:e.form,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"标题"}},[t("el-input",{attrs:{placeholder:"请输入标题"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),t("el-form-item",{attrs:{label:"封面图片"}},[t("el-upload",{staticClass:"upload-block",attrs:{action:e.dummyAction,"http-request":e.uploadImage,"show-file-list":!1,accept:"image/*"}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("上传图片")])],1),e.form.imageUrl?t("div",{staticClass:"preview"},[t("el-image",{staticStyle:{width:"200px",height:"110px"},attrs:{src:e.normalizeUrl(e.form.imageUrl),fit:"cover"}})],1):e._e()],1),t("el-form-item",{attrs:{label:"跳转类型"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.form.linkType,callback:function(t){e.$set(e.form,"linkType",t)},expression:"form.linkType"}},[t("el-option",{attrs:{label:"无",value:"none"}}),t("el-option",{attrs:{label:"小程序页面",value:"miniapp"}}),t("el-option",{attrs:{label:"外部链接",value:"web"}})],1)],1),"none"!==e.form.linkType?t("el-form-item",{attrs:{label:"跳转值"}},[t("el-input",{attrs:{placeholder:"小程序路径或外部链接"},model:{value:e.form.linkValue,callback:function(t){e.$set(e.form,"linkValue",t)},expression:"form.linkValue"}})],1):e._e(),t("el-form-item",{attrs:{label:"排序"}},[t("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,step:1},model:{value:e.form.sortOrder,callback:function(t){e.$set(e.form,"sortOrder",t)},expression:"form.sortOrder"}})],1),t("el-form-item",{attrs:{label:"是否启用"}},[t("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:e.form.isEnabled,callback:function(t){e.$set(e.form,"isEnabled",t)},expression:"form.isEnabled"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",loading:e.saving},on:{click:e.submit}},[e._v("保存")])],1)],1)],1)])},l=[],o=r(9550),s=r(6879),i={name:"CourseBanner",data(){return{loading:!1,list:[],dialogVisible:!1,dialogTitle:"新增轮播图",saving:!1,dummyAction:"about:blank",form:this.getEmptyForm()}},mounted(){this.loadList()},methods:{getEmptyForm(){return{id:null,title:"",imageUrl:"",linkType:"none",linkValue:"",sortOrder:0,isEnabled:1}},async loadList(){this.loading=!0;try{const e=await o.kY.list();200===e.code&&(this.list=e.data||[])}finally{this.loading=!1}},openDialog(e){e?(this.dialogTitle="编辑轮播图",this.form={...e}):(this.dialogTitle="新增轮播图",this.form=this.getEmptyForm()),this.dialogVisible=!0},async submit(){if(this.form.imageUrl){this.saving=!0;try{this.form.id?await o.kY.update(this.form.id,this.form):await o.kY.create(this.form),this.$message.success("保存成功"),this.dialogVisible=!1,this.loadList()}catch(e){this.$message.error("保存失败")}finally{this.saving=!1}}else this.$message.warning("请上传封面图片")},async handleDelete(e){try{await this.$confirm("确认删除该轮播图？","提示",{type:"warning"}),await o.kY.remove(e.id),this.$message.success("删除成功"),this.loadList()}catch(t){"cancel"!==t&&this.$message.error("删除失败")}},async uploadImage(e){try{const t=new FormData;t.append("file",e.file);const r=await(0,s.A)({url:"/mini/upload/file",method:"post",data:t,headers:{"Content-Type":"multipart/form-data"}});r&&200===r.code&&r.data?(this.form.imageUrl=r.data.url,e.onSuccess(r,e.file)):e.onError(new Error("上传失败"))}catch(t){e.onError(t)}},normalizeUrl(e){if(!e)return"";if(/^https?:\/\//.test(e))return e;const t=e.startsWith("/")?e:`/${e}`,r="/api";return`${r}${t}`},getLinkTypeText(e){const t={none:"无",miniapp:"小程序页面",web:"外部链接"};return t[e]||"无"},formatDate(e){return e?new Date(e).toLocaleString():""}}},n=i,u=r(1656),c=(0,u.A)(n,a,l,!1,null,"7e94c93a",null),d=c.exports},9550:function(e,t,r){r.d(t,{E8:function(){return u},MF:function(){return d},S9:function(){return l},Wd:function(){return n},_Y:function(){return s},jX:function(){return o},kY:function(){return c},s_:function(){return i}});var a=r(6879);function l(){return(0,a.A)({url:"/system/teacher-level/list",method:"get"})}function o(e){return(0,a.A)({url:"/system/teacher-level",method:"post",data:e})}function s(e,t){return(0,a.A)({url:`/system/teacher-level/${e}`,method:"put",data:t})}function i(e){return(0,a.A)({url:`/system/teacher-level/${e}`,method:"delete"})}const n={list(){return(0,a.A)({url:"/system/learning-system/list",method:"get"})},create(e){return(0,a.A)({url:"/system/learning-system",method:"post",data:e})},update(e,t){return(0,a.A)({url:`/system/learning-system/${e}`,method:"put",data:t})},remove(e){return(0,a.A)({url:`/system/learning-system/${e}`,method:"delete"})}},u={current(){return(0,a.A)({url:"/system/lesson-price/current",method:"get"})},save(e){return(0,a.A)({url:"/system/lesson-price/save",method:"post",data:e})}},c={list(e){return(0,a.A)({url:"/system/course-banner/list",method:"get",params:e})},create(e){return(0,a.A)({url:"/system/course-banner",method:"post",data:e})},update(e,t){return(0,a.A)({url:`/system/course-banner/${e}`,method:"put",data:t})},remove(e){return(0,a.A)({url:`/system/course-banner/${e}`,method:"delete"})}},d={list(e){return(0,a.A)({url:"/course-category/list",method:"get",params:e})},tree(){return(0,a.A)({url:"/course-category/tree",method:"get"})},topLevel(){return(0,a.A)({url:"/course-category/top-level",method:"get"})},detail(e){return(0,a.A)({url:`/course-category/${e}`,method:"get"})},create(e){return(0,a.A)({url:"/course-category",method:"post",data:e})},update(e,t){return(0,a.A)({url:`/course-category/${e}`,method:"put",data:t})},updateStatus(e,t){return(0,a.A)({url:`/course-category/${e}/status`,method:"post",params:{status:t}})},updateSort(e,t){return(0,a.A)({url:`/course-category/${e}/sort`,method:"post",params:{sortOrder:t}})},move(e,t){return(0,a.A)({url:`/course-category/${e}/move`,method:"post",params:{newParentId:t}})},delete(e){return(0,a.A)({url:`/course-category/${e}`,method:"delete"})},batchDelete(e){return(0,a.A)({url:"/course-category/batch",method:"delete",data:e})},checkCode(e,t){return(0,a.A)({url:"/course-category/check-code",method:"get",params:{categoryCode:e,excludeId:t}})},checkName(e,t,r){return(0,a.A)({url:"/course-category/check-name",method:"get",params:{categoryName:e,parentId:t,excludeId:r}})}}}}]);