"use strict";(self["webpackChunkadmin_frontend"]=self["webpackChunkadmin_frontend"]||[]).push([[126],{1429:function(t,a,e){e.d(a,{BM:function(){return l},KU:function(){return r},Kh:function(){return c},Pj:function(){return u},Rc:function(){return d},n7:function(){return n},qS:function(){return o},sG:function(){return i}});var s=e(6879);function n(t){return(0,s.A)({url:"/finance/orders/list",method:"post",data:t})}function r(t){return(0,s.A)({url:`/finance/orders/${t}`,method:"get"})}function l(){return(0,s.A)({url:"/finance/statistics",method:"get"})}function i(){return(0,s.A)({url:"/finance/statistics/orders",method:"get"})}function o(){return(0,s.A)({url:"/finance/statistics/payment-methods",method:"get"})}function c(){return(0,s.A)({url:"/finance/statistics/course-types",method:"get"})}function d(t=10){return(0,s.A)({url:"/finance/statistics/teacher-revenue-ranking",method:"get",params:{limit:t}})}function u(t=10){return(0,s.A)({url:"/finance/statistics/student-consumption-ranking",method:"get",params:{limit:t}})}},6126:function(t,a,e){e.r(a),e.d(a,{default:function(){return d}});var s=function(){var t=this,a=t._self._c;return a("div",{staticClass:"page-container"},[a("div",{staticClass:"content-box"},[a("h2",[t._v("财务统计")]),a("el-row",{staticClass:"mb-20",attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"stat-card"},[a("div",{staticClass:"stat-icon",staticStyle:{background:"#67C23A"}},[a("i",{staticClass:"el-icon-money"})]),a("div",{staticClass:"stat-content"},[a("div",{staticClass:"stat-title"},[t._v("总收入")]),a("div",{staticClass:"stat-value"},[t._v("¥"+t._s(t.formatAmount(t.statistics.totalRevenue)))]),a("div",{staticClass:"stat-trend"},[t._v("今日：¥"+t._s(t.formatAmount(t.statistics.todayRevenue)))])])])]),a("el-col",{attrs:{span:6}},[a("div",{staticClass:"stat-card"},[a("div",{staticClass:"stat-icon",staticStyle:{background:"#409EFF"}},[a("i",{staticClass:"el-icon-s-order"})]),a("div",{staticClass:"stat-content"},[a("div",{staticClass:"stat-title"},[t._v("总订单")]),a("div",{staticClass:"stat-value"},[t._v(t._s(t.statistics.totalOrders||0))]),a("div",{staticClass:"stat-trend"},[t._v("今日："+t._s(t.statistics.todayOrders||0))])])])]),a("el-col",{attrs:{span:6}},[a("div",{staticClass:"stat-card"},[a("div",{staticClass:"stat-icon",staticStyle:{background:"#E6A23C"}},[a("i",{staticClass:"el-icon-success"})]),a("div",{staticClass:"stat-content"},[a("div",{staticClass:"stat-title"},[t._v("支付成功率")]),a("div",{staticClass:"stat-value"},[t._v(t._s(t.formatPercent(t.statistics.paymentSuccessRate))+"%")]),a("div",{staticClass:"stat-trend"},[t._v("客单价：¥"+t._s(t.formatAmount(t.statistics.avgOrderAmount)))])])])]),a("el-col",{attrs:{span:6}},[a("div",{staticClass:"stat-card"},[a("div",{staticClass:"stat-icon",staticStyle:{background:"#F56C6C"}},[a("i",{staticClass:"el-icon-warning"})]),a("div",{staticClass:"stat-content"},[a("div",{staticClass:"stat-title"},[t._v("退款率")]),a("div",{staticClass:"stat-value"},[t._v(t._s(t.formatPercent(t.statistics.refundRate))+"%")]),a("div",{staticClass:"stat-trend"},[t._v("退款：¥"+t._s(t.formatAmount(t.statistics.totalRefundAmount)))])])])])],1),a("el-row",{staticClass:"mb-20",attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-card",[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[t._v("收入趋势（近30天）")]),a("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:t.refreshTrend}},[t._v("刷新")])],1),a("div",{staticStyle:{height:"300px",display:"flex","align-items":"center","justify-content":"center",color:"#909399"},attrs:{id:"revenue-chart"}},[a("i",{staticClass:"el-icon-pie-chart",staticStyle:{"font-size":"48px","margin-right":"16px"}}),a("span",[t._v("收入趋势图表")])])])],1),a("el-col",{attrs:{span:12}},[a("el-card",[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[t._v("订单状态分布")])]),a("div",{staticStyle:{height:"300px",display:"flex","align-items":"center","justify-content":"center",color:"#909399"},attrs:{id:"order-status-chart"}},[a("i",{staticClass:"el-icon-pie-chart",staticStyle:{"font-size":"48px","margin-right":"16px"}}),a("span",[t._v("订单分布图表")])])])],1)],1),a("el-row",{staticClass:"mb-20",attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-card",[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[t._v("支付方式分布")])]),a("el-table",{attrs:{data:t.paymentMethods,stripe:""}},[a("el-table-column",{attrs:{prop:"methodName",label:"支付方式",width:"120"}}),a("el-table-column",{attrs:{prop:"amount",label:"金额"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" ¥"+t._s(t.formatAmount(a.row.amount))+" ")]}}])}),a("el-table-column",{attrs:{prop:"orderCount",label:"订单数",width:"80"}}),a("el-table-column",{attrs:{prop:"percentage",label:"占比",width:"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" "+t._s(t.formatPercent(a.row.percentage))+"% ")]}}])})],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-card",[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[t._v("课程类型收入")])]),a("el-table",{attrs:{data:t.courseTypes,stripe:""}},[a("el-table-column",{attrs:{prop:"typeName",label:"课程类型",width:"120"}}),a("el-table-column",{attrs:{prop:"revenue",label:"收入"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" ¥"+t._s(t.formatAmount(a.row.revenue))+" ")]}}])}),a("el-table-column",{attrs:{prop:"orderCount",label:"订单数",width:"80"}}),a("el-table-column",{attrs:{prop:"percentage",label:"占比",width:"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" "+t._s(t.formatPercent(a.row.percentage))+"% ")]}}])})],1)],1)],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-card",[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[t._v("教师收入排行 TOP10")])]),a("el-table",{attrs:{data:t.teacherRanking,stripe:""}},[a("el-table-column",{attrs:{type:"index",label:"排名",width:"60"}}),a("el-table-column",{attrs:{prop:"teacherName",label:"教师",width:"100"}}),a("el-table-column",{attrs:{prop:"subject",label:"科目",width:"80"}}),a("el-table-column",{attrs:{prop:"revenue",label:"收入"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" ¥"+t._s(t.formatAmount(a.row.revenue))+" ")]}}])}),a("el-table-column",{attrs:{prop:"orderCount",label:"订单数",width:"80"}})],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-card",[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",[t._v("学生消费排行 TOP10")])]),a("el-table",{attrs:{data:t.studentRanking,stripe:""}},[a("el-table-column",{attrs:{type:"index",label:"排名",width:"60"}}),a("el-table-column",{attrs:{prop:"studentName",label:"学生",width:"100"}}),a("el-table-column",{attrs:{prop:"level",label:"等级",width:"80"}}),a("el-table-column",{attrs:{prop:"consumption",label:"消费"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" ¥"+t._s(t.formatAmount(a.row.consumption))+" ")]}}])}),a("el-table-column",{attrs:{prop:"orderCount",label:"订单数",width:"80"}})],1)],1)],1)],1)],1)])},n=[],r=e(1429),l={name:"FinancialStatistics",data(){return{loading:!1,statistics:{},revenueTrend:[],paymentMethods:[],courseTypes:[],teacherRanking:[],studentRanking:[]}},created(){this.loadAllData()},methods:{async loadAllData(){this.loading=!0;try{await Promise.all([this.loadStatistics(),this.loadPaymentMethods(),this.loadCourseTypes(),this.loadTeacherRanking(),this.loadStudentRanking()])}finally{this.loading=!1}},async loadStatistics(){try{const t=await(0,r.BM)();200===t.code&&(this.statistics=t.data)}catch(t){console.error("加载统计数据失败",t)}},async loadPaymentMethods(){try{const t=await(0,r.qS)();200===t.code&&(this.paymentMethods=t.data.map(t=>({...t,methodName:this.getPaymentMethodName(t.paymentMethod)})))}catch(t){console.error("加载支付方式数据失败",t)}},async loadCourseTypes(){try{const t=await(0,r.Kh)();200===t.code&&(this.courseTypes=t.data.map(t=>({...t,typeName:this.getCourseTypeName(t.courseType)})))}catch(t){console.error("加载课程类型数据失败",t)}},async loadTeacherRanking(){try{const t=await(0,r.Rc)(10);200===t.code&&(this.teacherRanking=t.data)}catch(t){console.error("加载教师排行数据失败",t)}},async loadStudentRanking(){try{const t=await(0,r.Pj)(10);200===t.code&&(this.studentRanking=t.data)}catch(t){console.error("加载学生排行数据失败",t)}},refreshTrend(){this.$message.info("图表数据刷新功能开发中")},formatAmount(t){return t?Number(t).toFixed(2):"0.00"},formatPercent(t){return t?Number(t).toFixed(2):"0.00"},getPaymentMethodName(t){const a={wechat:"微信支付",alipay:"支付宝",balance:"余额支付"};return a[t]||t},getCourseTypeName(t){const a={one_on_one:"一对一",small_class:"小班课",live_class:"直播课"};return a[t]||t}}},i=l,o=e(1656),c=(0,o.A)(i,s,n,!1,null,"4641fd46",null),d=c.exports}}]);