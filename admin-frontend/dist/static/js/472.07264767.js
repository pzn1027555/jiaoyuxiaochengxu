"use strict";(self["webpackChunkadmin_frontend"]=self["webpackChunkadmin_frontend"]||[]).push([[472],{314:function(e,t,i){i.d(t,{E8:function(){return c},F4:function(){return o},FJ:function(){return s},Uh:function(){return n},aC:function(){return a},o8:function(){return u},q4:function(){return l},vz:function(){return d}});var r=i(6879);function o(e){return(0,r.A)({url:"/community/posts/list",method:"post",data:e})}function a(e){return(0,r.A)({url:`/community/posts/${e}`,method:"get"})}function l(e,t){return(0,r.A)({url:`/community/posts/${e}/take-down`,method:"put",params:{reason:t}})}function s(e){return(0,r.A)({url:"/community/resources/list",method:"post",data:e})}function c(e,t){return(0,r.A)({url:`/community/resources/${e}`,method:"get",params:t?{source:t}:void 0})}function n(e){return(0,r.A)({url:"/community/resources/update",method:"put",data:e})}function u(e,t){return(0,r.A)({url:`/community/resources/${e}`,method:"delete",params:t?{source:t}:void 0})}function d(e,t,i){return(0,r.A)({url:`/community/resources/${e}/download`,method:"get",params:i?{source:i,userId:t}:{userId:t}})}},6472:function(e,t,i){i.r(t),i.d(t,{default:function(){return d}});var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"page-container"},[t("div",{staticClass:"content-box"},[t("h2",[e._v("资源管理")]),t("el-tabs",{staticClass:"mb-10",on:{"tab-click":e.handleSourceChange},model:{value:e.activeSource,callback:function(t){e.activeSource=t},expression:"activeSource"}},[t("el-tab-pane",{attrs:{label:"社区资源",name:"community"}}),t("el-tab-pane",{attrs:{label:"教师资源",name:"teacher"}})],1),t("el-form",{staticClass:"search-form",attrs:{model:e.queryForm,inline:!0}},[t("el-form-item",{attrs:{label:"关键词"}},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"搜索标题和描述",clearable:""},model:{value:e.queryForm.keyword,callback:function(t){e.$set(e.queryForm,"keyword",t)},expression:"queryForm.keyword"}})],1),t("el-form-item",{attrs:{label:"上传者"}},[t("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"请输入上传者姓名",clearable:""},model:{value:e.queryForm.uploaderName,callback:function(t){e.$set(e.queryForm,"uploaderName",t)},expression:"queryForm.uploaderName"}})],1),"community"===e.activeSource?t("el-form-item",{attrs:{label:"学科"}},[t("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择学科",clearable:""},model:{value:e.queryForm.subject,callback:function(t){e.$set(e.queryForm,"subject",t)},expression:"queryForm.subject"}},[t("el-option",{attrs:{label:"数学",value:"math"}}),t("el-option",{attrs:{label:"物理",value:"physics"}}),t("el-option",{attrs:{label:"化学",value:"chemistry"}}),t("el-option",{attrs:{label:"生物",value:"biology"}}),t("el-option",{attrs:{label:"其他",value:"other"}})],1)],1):e._e(),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("搜索")]),t("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.handleReset}},[e._v("重置")])],1)],1),t("div",{staticClass:"toolbar"},[t("div",{staticClass:"toolbar-left"},["community"===e.activeSource?t("el-button",{attrs:{type:"success",icon:"el-icon-upload"},on:{click:e.openCreateDialog}},[e._v(" 发布 ")]):e._e()],1),t("div",{staticClass:"toolbar-right"},[t("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:e.handleRefresh}},[e._v("刷新")])],1)]),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.resourceList,stripe:"",border:""},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),t("el-table-column",{attrs:{prop:"title",label:"标题"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-link",{attrs:{type:"primary"},on:{click:function(t){return e.viewResourceDetail(i.row)}}},[e._v(e._s(i.row.title))])]}}])}),t("el-table-column",{attrs:{prop:"uploaderName",label:"上传者",width:"150"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("div",[e._v(e._s(i.row.uploaderName))])]}}])}),"teacher"===e.activeSource?t("el-table-column",{attrs:{label:"资源类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getResourceTypeText(t.row.fileType))+" ")]}}],null,!1,2740749595)}):e._e(),"teacher"===e.activeSource?t("el-table-column",{attrs:{label:"描述","min-width":"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.description||"-")+" ")]}}],null,!1,4064771542)}):e._e(),"community"===e.activeSource?t("el-table-column",{attrs:{label:"统计数据",width:"120"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("div",[e._v("下载: "+e._s(i.row.downloadCount||0))]),t("div",[e._v("浏览: "+e._s(i.row.viewCount||0))]),t("div",[e._v("点赞: "+e._s(i.row.likeCount||0))]),t("div",[e._v("评分: "+e._s(e.formatRating(i.row.avgRating)))])]}}],null,!1,2423170995)}):e._e(),"community"===e.activeSource?t("el-table-column",{attrs:{label:"价格信息",width:"100"},scopedSlots:e._u([{key:"default",fn:function(i){return[i.row.isFree?t("div",[t("el-tag",{attrs:{type:"success",size:"mini"}},[e._v("免费")])],1):i.row.requirePoints?t("div",[t("el-tag",{attrs:{type:"warning",size:"mini"}},[e._v(e._s(i.row.pointsRequired)+"积分")])],1):t("div",[t("el-tag",{attrs:{type:"primary",size:"mini"}},[e._v("¥"+e._s(e.formatAmount(i.row.price)))])],1)]}}],null,!1,4018688688)}):e._e(),t("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatDateTime(t.row.createTime))+" ")]}}])}),t("el-table-column",{attrs:{label:"操作",width:"teacher"===e.activeSource?120:280,fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(i){return["teacher"===e.activeSource?[t("el-button",{staticStyle:{color:"#F56C6C"},attrs:{type:"text",size:"mini"},on:{click:function(t){return e.deleteResource(i.row)}}},[e._v("删除")])]:[t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.viewResourceDetail(i.row)}}},[e._v("查看详情")]),t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.openEdit(i.row)}}},[e._v("编辑")]),t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.downloadResource(i.row)}}},[e._v("下载资源")]),t("el-button",{staticStyle:{color:"#F56C6C"},attrs:{type:"text",size:"mini"},on:{click:function(t){return e.deleteResource(i.row)}}},[e._v("删除")])]]}}])})],1),t("div",{staticClass:"pagination-wrapper"},[t("el-pagination",{attrs:{"current-page":e.queryForm.pageNum,"page-sizes":[10,20,50,100],"page-size":e.queryForm.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),t("el-dialog",{attrs:{title:"资源详情",visible:e.detailDialogVisible,width:"800px"},on:{"update:visible":function(t){e.detailDialogVisible=t}}},[e.resourceDetail?t("div",[t("h3",[e._v(e._s(e.resourceDetail.title))]),t("p",[t("strong",[e._v("上传者:")]),e._v(" "+e._s(e.resourceDetail.uploaderName))]),t("p",[t("strong",[e._v("资源类型:")]),e._v(" "+e._s(e.getResourceTypeText(e.resourceDetail.resourceType||e.resourceDetail.fileType)))]),t("p",[t("strong",[e._v("创建时间:")]),e._v(" "+e._s(e.formatDateTime(e.resourceDetail.createTime)))]),e.resourceDetail.coverUrl?t("div",{staticStyle:{"margin-top":"10px"}},[t("strong",[e._v("封面:")]),t("div",{staticStyle:{"margin-top":"10px"}},[t("el-image",{staticStyle:{width:"240px",height:"135px"},attrs:{src:e.normalizeUrl(e.resourceDetail.coverUrl),fit:"cover"}})],1)]):e._e(),"community"===e.activeSource?t("div",{staticStyle:{"margin-top":"20px"}},[t("strong",[e._v("描述:")]),t("div",{staticStyle:{"margin-top":"10px",padding:"10px",border:"1px solid #ddd","border-radius":"4px"}},[e._v(" "+e._s(e.resourceDetail.description)+" ")])]):e._e()]):e._e(),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.detailDialogVisible=!1}}},[e._v("关闭")]),t("el-button",{attrs:{type:"primary"},on:{click:e.openEditFromDetail}},[e._v("编辑")])],1)]),t("el-dialog",{attrs:{title:"发布社区资源",visible:e.createDialogVisible,width:"600px"},on:{"update:visible":function(t){e.createDialogVisible=t}}},[t("el-form",{attrs:{model:e.createForm,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"标题"}},[t("el-input",{attrs:{placeholder:"请输入标题"},model:{value:e.createForm.title,callback:function(t){e.$set(e.createForm,"title",t)},expression:"createForm.title"}})],1),t("el-form-item",{attrs:{label:"描述"}},[t("el-input",{attrs:{type:"textarea",rows:4,placeholder:"资源描述（可选）"},model:{value:e.createForm.description,callback:function(t){e.$set(e.createForm,"description",t)},expression:"createForm.description"}})],1),t("el-form-item",{attrs:{label:"价格(元)"}},[t("el-input",{attrs:{type:"number",min:"0",placeholder:"如需收费请输入价格"},model:{value:e.createForm.price,callback:function(t){e.$set(e.createForm,"price",e._n(t))},expression:"createForm.price"}})],1),t("el-form-item",{attrs:{label:"文件上传"}},[t("el-upload",{staticClass:"upload-block",attrs:{action:e.dummyAction,"http-request":e.uploadFile,accept:e.acceptFiles,limit:1,"on-success":e.handleFileSuccess,"on-remove":e.handleFileRemove,"file-list":e.fileList,"show-file-list":!0}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("选择文件")]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("支持 pdf/doc/docx/ppt/pptx/mp4 等")])],1)],1),t("el-form-item",{attrs:{label:"封面上传"}},[t("el-upload",{staticClass:"cover-uploader",attrs:{action:e.dummyAction,"http-request":e.uploadCover,accept:"image/*",limit:1,"on-success":e.handleCoverSuccess,"on-remove":e.handleCoverRemove,"file-list":e.coverList,"list-type":"picture-card"}},[t("i",{staticClass:"el-icon-plus"})])],1),t("el-form-item",{attrs:{label:"文件类型"}},[t("el-select",{attrs:{placeholder:"选择类型"},model:{value:e.createForm.fileType,callback:function(t){e.$set(e.createForm,"fileType",t)},expression:"createForm.fileType"}},[t("el-option",{attrs:{label:"文档",value:"document"}}),t("el-option",{attrs:{label:"视频",value:"video"}}),t("el-option",{attrs:{label:"音频",value:"audio"}}),t("el-option",{attrs:{label:"图片",value:"image"}}),t("el-option",{attrs:{label:"其他",value:"other"}})],1)],1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.createDialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",loading:e.createLoading},on:{click:e.submitCreate}},[e._v("发布")])],1)],1),t("el-dialog",{attrs:{title:"编辑资源",visible:e.editDialogVisible,width:"600px"},on:{"update:visible":function(t){e.editDialogVisible=t}}},[t("el-form",{attrs:{model:e.editForm,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"标题"}},[t("el-input",{attrs:{placeholder:"请输入标题"},model:{value:e.editForm.title,callback:function(t){e.$set(e.editForm,"title",t)},expression:"editForm.title"}})],1),t("el-form-item",{attrs:{label:"描述"}},[t("el-input",{attrs:{type:"textarea",rows:4,placeholder:"资源描述（可选）"},model:{value:e.editForm.description,callback:function(t){e.$set(e.editForm,"description",t)},expression:"editForm.description"}})],1),"community"===e.activeSource?t("el-form-item",{attrs:{label:"价格(元)"}},[t("el-input",{attrs:{type:"number",min:"0",placeholder:"如需收费请输入价格"},model:{value:e.editForm.price,callback:function(t){e.$set(e.editForm,"price",e._n(t))},expression:"editForm.price"}})],1):e._e(),t("el-form-item",{attrs:{label:"文件上传"}},[t("el-upload",{staticClass:"upload-block",attrs:{action:e.dummyAction,"http-request":e.uploadFile,accept:e.acceptFiles,limit:1,"on-success":e.handleEditFileSuccess,"on-remove":e.handleEditFileRemove,"file-list":e.editFileList,"show-file-list":!0}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("更换文件")]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("支持 pdf/doc/docx/ppt/pptx/mp4 等")])],1)],1),t("el-form-item",{attrs:{label:"封面上传"}},[t("el-upload",{staticClass:"cover-uploader",attrs:{action:e.dummyAction,"http-request":e.uploadCover,accept:"image/*",limit:1,"on-success":e.handleEditCoverSuccess,"on-remove":e.handleEditCoverRemove,"file-list":e.editCoverList,"list-type":"picture-card"}},[t("i",{staticClass:"el-icon-plus"})])],1),t("el-form-item",{attrs:{label:"文件类型"}},[t("el-select",{attrs:{placeholder:"选择类型"},model:{value:e.editForm.fileType,callback:function(t){e.$set(e.editForm,"fileType",t)},expression:"editForm.fileType"}},[t("el-option",{attrs:{label:"文档",value:"document"}}),t("el-option",{attrs:{label:"资料",value:"material"}}),t("el-option",{attrs:{label:"视频",value:"video"}}),t("el-option",{attrs:{label:"音频",value:"audio"}}),t("el-option",{attrs:{label:"图片",value:"image"}}),t("el-option",{attrs:{label:"其他",value:"other"}})],1)],1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",loading:e.editLoading},on:{click:e.submitEdit}},[e._v("保存")])],1)],1)],1)},o=[],a=i(314),l=i(6879),s={name:"ResourceManagement",data(){return{loading:!1,resourceList:[],total:0,selectedResources:[],statistics:{},activeSource:"community",queryForm:{keyword:"",uploaderName:"管理员",resourceType:"",source:"community",subject:"",resourceStatus:null,pageNum:1,pageSize:20},detailDialogVisible:!1,resourceDetail:null,auditDialogVisible:!1,auditLoading:!1,auditForm:{id:null,auditStatus:1,auditRemark:""},createDialogVisible:!1,createLoading:!1,createForm:{title:"",description:"",uploaderName:"",price:null,fileUrl:"",coverUrl:"",fileType:""},acceptFiles:".pdf,.doc,.docx,.ppt,.pptx,.mp4,.mov,.avi,.mkv,.flv,.wmv",fileList:[],coverList:[],editDialogVisible:!1,editLoading:!1,editForm:{id:null,title:"",description:"",uploaderName:"",price:null,fileUrl:"",coverUrl:"",fileType:""},editFileList:[],editCoverList:[],dummyAction:"about:blank"}},created(){this.loadResourceList()},watch:{activeSource(){this.handleSourceChange()}},methods:{handleSourceChange(){this.queryForm.source=this.activeSource,this.queryForm.pageNum=1,this.loadResourceList()},async loadResourceList(){this.loading=!0;try{const e=await(0,a.FJ)({...this.queryForm,source:this.activeSource});200===e.code&&(this.resourceList=(e.data.list||[]).map(e=>({...e,resourceStatus:null!=e.resourceStatus?e.resourceStatus:null!=e.status?e.status:1,fileType:e.fileType||e.type})),this.total=e.data.total)}catch(e){this.$message.error("加载资源列表失败")}finally{this.loading=!1}},async downloadResource(e){try{const t=await(0,a.vz)(e.id,1,this.activeSource);if(200===t.code&&t.data&&t.data.url){const e=t.data.url,i=this.normalizeUrl(e);window.open(i,"_blank")}else this.$message.error("未获取到下载链接")}catch(t){this.$message.error("下载失败")}},handleSearch(){this.queryForm.pageNum=1,this.loadResourceList()},handleReset(){this.queryForm={keyword:"",uploaderName:"",resourceType:"",source:"community",subject:"",resourceStatus:null,pageNum:1,pageSize:20},this.loadResourceList()},handleRefresh(){this.loadResourceList()},handleSizeChange(e){this.queryForm.pageSize=e,this.queryForm.pageNum=1,this.loadResourceList()},handleCurrentChange(e){this.queryForm.pageNum=e,this.loadResourceList()},handleSelectionChange(e){this.selectedResources=e},async viewResourceDetail(e){try{const t=await(0,a.E8)(e.id,this.activeSource);200===t.code&&(this.resourceDetail=t.data,this.detailDialogVisible=!0)}catch(t){this.$message.error("获取资源详情失败")}},async openEdit(e){try{const t=await(0,a.E8)(e.id,this.activeSource);if(200===t.code){const e=t.data||{};this.editForm={id:e.id,title:e.title||"",description:e.description||"",uploaderName:e.uploaderName||"管理员",price:null!=e.price?e.price:null,fileUrl:e.fileUrl||"",coverUrl:e.coverUrl||"",fileType:e.fileType||e.type||""},this.editFileList=this.editForm.fileUrl?[{name:this.editForm.title||"文件",url:this.normalizeUrl(this.editForm.fileUrl)}]:[],this.editCoverList=this.editForm.coverUrl?[{name:"封面",url:this.normalizeUrl(this.editForm.coverUrl)}]:[],this.editDialogVisible=!0}}catch(t){this.$message.error("打开编辑失败")}},openEditFromDetail(){if(!this.resourceDetail)return;const e=this.resourceDetail;this.editForm={id:e.id,title:e.title||"",description:e.description||"",uploaderName:e.uploaderName||"管理员",price:null!=e.price?e.price:null,fileUrl:e.fileUrl||"",coverUrl:e.coverUrl||"",fileType:e.fileType||e.type||""},this.editFileList=this.editForm.fileUrl?[{name:this.editForm.title||"文件",url:this.normalizeUrl(this.editForm.fileUrl)}]:[],this.editCoverList=this.editForm.coverUrl?[{name:"封面",url:this.normalizeUrl(this.editForm.coverUrl)}]:[],this.editDialogVisible=!0},async submitEdit(){if(this.editForm.id&&this.editForm.title){this.editLoading=!0;try{const e={...this.editForm,source:this.activeSource},t=await(0,a.Uh)(e);200===t.code&&(this.$message.success("保存成功"),this.editDialogVisible=!1,this.detailDialogVisible&&this.resourceDetail&&this.resourceDetail.id===this.editForm.id&&(this.resourceDetail={...this.resourceDetail,...this.editForm}),this.loadResourceList())}catch(e){this.$message.error("保存失败")}finally{this.editLoading=!1}}else this.$message.warning("请填写标题")},async batchPublish(){this.$message.info("批量发布功能开发中")},async deleteResource(e){try{await this.$confirm("确认删除该资源？将被标记为删除","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await this.$confirm("再次确认删除该资源？此操作不可恢复","二次确认",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning"});const t=await(0,a.o8)(e.id,this.activeSource);200===t.code&&(this.$message.success("已删除"),this.loadResourceList())}catch(t){"cancel"!==t&&this.$message.error("删除失败")}},openCreateDialog(){this.createForm={title:"",description:"",uploaderName:"管理员",price:null,fileUrl:"",coverUrl:"",fileType:""},this.fileList=[],this.coverList=[],this.createDialogVisible=!0},async submitCreate(){if(!this.createForm.title||!this.createForm.fileUrl)return void this.$message.warning("请填写标题与文件URL");const e={...this.createForm};e.fileUrl=this.stripApiBase(e.fileUrl),e.coverUrl=this.stripApiBase(e.coverUrl),this.createLoading=!0;try{const t=await(0,l.A)({url:"/community/resources/create",method:"post",data:e});200===t.code&&(this.$message.success("发布成功"),this.createDialogVisible=!1,this.loadResourceList())}catch(t){this.$message.error("发布失败")}finally{this.createLoading=!1}},async uploadFile(e){try{if(!e||!e.file)return void e?.onError?.(new Error("请选择文件"));const t=new FormData;t.append("file",e.file);const i=await(0,l.A)({url:"/mini/upload/file",method:"post",data:t,headers:{"Content-Type":"multipart/form-data"}});i&&200===i.code&&i.data?e.onSuccess(i,e.file):e.onError(new Error(i?.message||"上传失败"))}catch(t){e.onError(t)}},async uploadCover(e){try{if(!e||!e.file)return void e?.onError?.(new Error("请选择图片"));if(e.file.type&&!/^image\//i.test(e.file.type))return void e.onError(new Error("封面仅支持图片格式"));const t=new FormData;t.append("file",e.file);const i=await(0,l.A)({url:"/mini/upload/file",method:"post",data:t,headers:{"Content-Type":"multipart/form-data"}});i&&200===i.code&&i.data?e.onSuccess(i,e.file):e.onError(new Error(i?.message||"上传失败"))}catch(t){e.onError(t)}},handleFileSuccess(e,t){if(e&&200===e.code&&e.data){this.createForm.fileUrl=e.data.url,e.data.coverUrl&&(this.createForm.coverUrl=e.data.coverUrl);const i=(e.data.url||"").toLowerCase();i.match(/\.(pdf|doc|docx|ppt|pptx)$/)?this.createForm.fileType="document":i.match(/\.(mp4|mov|avi|mkv|flv|wmv)$/)?this.createForm.fileType="video":this.createForm.fileType="other",this.fileList=[{name:t.name||"文件",url:this.normalizeUrl(this.createForm.fileUrl)}]}},handleFileRemove(){this.createForm.fileUrl="",this.fileList=[]},handleCoverSuccess(e,t){e&&200===e.code&&e.data&&(this.createForm.coverUrl=e.data.url,this.coverList=[{name:"封面",url:this.normalizeUrl(this.createForm.coverUrl)}])},handleCoverRemove(){this.createForm.coverUrl="",this.coverList=[]},handleEditFileSuccess(e,t){if(e&&200===e.code&&e.data){this.editForm.fileUrl=e.data.url;const i=(e.data.url||"").toLowerCase();i.match(/\.(pdf|doc|docx|ppt|pptx)$/)?this.editForm.fileType="document":i.match(/\.(mp4|mov|avi|mkv|flv|wmv)$/)?this.editForm.fileType="video":this.editForm.fileType=this.editForm.fileType||"other",this.editFileList=[{name:t.name||"文件",url:this.normalizeUrl(this.editForm.fileUrl)}]}},handleEditFileRemove(){this.editForm.fileUrl="",this.editFileList=[]},handleEditCoverSuccess(e,t){e&&200===e.code&&e.data&&(this.editForm.coverUrl=e.data.url,this.editCoverList=[{name:"封面",url:this.normalizeUrl(this.editForm.coverUrl)}])},handleEditCoverRemove(){this.editForm.coverUrl="",this.editCoverList=[]},normalizeUrl(e){if(!e)return"";if(/^https?:\/\//.test(e))return e;const t=e.startsWith("/")?e:`/${e}`,i="/api";return`${i}${t}`},stripApiBase(e){if(!e)return"";const t="/api";if(e.startsWith(t))return e.slice(t.length);try{const i=new URL(e),r=i.pathname;return r.startsWith(t)?r.slice(t.length):r}catch(i){return e}},formatDateTime(e){return e?new Date(e).toLocaleString():"-"},formatAmount(e){return e?Number(e).toFixed(2):"0.00"},formatRating(e){return e?Number(e).toFixed(1):"0.0"},getFileSizeText(e){if(!e||0===e)return"0 B";const t=["B","KB","MB","GB","TB"];let i=0,r=Number(e);while(r>=1024&&i<t.length-1)r/=1024,i++;return r.toFixed(2)+" "+t[i]},getResourceStatusText(e){const t={0:"草稿",1:"待审核",2:"已发布",3:"已下架",4:"已删除"};return t[e]||"未知状态"},getResourceStatusType(e){const t={0:"info",1:"warning",2:"success",3:"danger",4:"info"};return t[e]||""},getResourceTypeText(e){const t={document:"文档",material:"资料",video:"视频",audio:"音频",image:"图片",course:"课程",other:"其他"};return t[e]||"文档"},getSourceText(e){const t={community:"社区",teacher:"教师"};return t[e]||"社区"},getSubjectText(e){const t={math:"数学",physics:"物理",chemistry:"化学",biology:"生物",other:"其他"};return t[e]||"数学"},getUploaderTypeText(e){const t={student:"学生",teacher:"教师",admin:"管理员"};return t[e]||"学生"},getUploaderTypeColor(e){const t={student:"",teacher:"success",admin:"warning"};return t[e]||""},getViolationTypeText(e){const t={copyright:"版权问题",inappropriate:"不当内容",virus:"病毒文件",other:"其他"};return t[e]||""}}},c=s,n=i(1656),u=(0,n.A)(c,r,o,!1,null,"3d17f13c",null),d=u.exports}}]);