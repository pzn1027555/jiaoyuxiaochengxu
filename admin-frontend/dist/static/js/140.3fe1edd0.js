"use strict";(self["webpackChunkadmin_frontend"]=self["webpackChunkadmin_frontend"]||[]).push([[140],{7140:function(t,e,a){a.r(e),a.d(e,{default:function(){return u}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"refund-manage"},[e("div",{staticClass:"filter-container"},[e("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.query}},[e("el-form-item",{attrs:{label:"状态"}},[e("el-select",{staticStyle:{width:"160px"},attrs:{clearable:"",placeholder:"全部"},model:{value:t.query.status,callback:function(e){t.$set(t.query,"status",e)},expression:"query.status"}},[e("el-option",{attrs:{label:"申请中",value:"applied"}}),e("el-option",{attrs:{label:"处理中",value:"processing"}}),e("el-option",{attrs:{label:"退款完成",value:"completed"}}),e("el-option",{attrs:{label:"已撤回",value:"revoked"}})],1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.getList}},[e("i",{staticClass:"el-icon-search"}),t._v(" 查询")]),e("el-button",{on:{click:t.reset}},[e("i",{staticClass:"el-icon-refresh"}),t._v(" 重置")])],1)],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.list,border:""}},[e("el-table-column",{attrs:{prop:"orderNo",label:"订单号",width:"160"}}),e("el-table-column",{attrs:{prop:"studentName",label:"学生",width:"120"}}),e("el-table-column",{attrs:{prop:"teacherName",label:"教师",width:"120"}}),e("el-table-column",{attrs:{prop:"courseName",label:"课程名称",width:"200","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"amount",label:"金额",width:"100"}}),e("el-table-column",{attrs:{prop:"reason",label:"原因",width:"240","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"status",label:"状态",width:"120"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tag",{attrs:{type:t.tagType(a.row.status),size:"small"}},[t._v(t._s(t.statusText(a.row.status)))])]}}])}),e("el-table-column",{attrs:{prop:"createTime",label:"申请时间",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.formatDate(e.row.createTime)))]}}])}),e("el-table-column",{attrs:{label:"操作",width:"220",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{size:"mini",type:"primary",disabled:"completed"===a.row.status||"revoked"===a.row.status},on:{click:function(e){return t.approve(a.row)}}},[t._v("同意")]),e("el-button",{attrs:{size:"mini",type:"danger",disabled:"completed"===a.row.status||"revoked"===a.row.status},on:{click:function(e){return t.reject(a.row)}}},[t._v("驳回")])]}}])})],1),e("div",{staticClass:"pagination-container"},[e("el-pagination",{attrs:{"current-page":t.query.page,"page-sizes":[10,20,30,50],"page-size":t.query.size,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":e=>{t.query.size=e,t.query.page=1,t.getList()},"current-change":e=>{t.query.page=e,t.getList()}}})],1)],1)},r=[],l=a(6879),i={name:"RefundManage",data(){return{loading:!1,list:[],total:0,query:{page:1,size:10,status:""}}},created(){this.getList()},methods:{async getList(){this.loading=!0;try{const t=await(0,l.A)({url:"/admin/refund/list",method:"get",params:this.query});if(t&&(200===t.code||t.success)){const e=t.data||t.result||{};this.list=e.items||e.list||[],this.total=e.total||0}}finally{this.loading=!1}},async approve(t){try{await this.$confirm("确认同意退款并将金额退回到家长余额吗？","提示");const e=await(0,l.A)({url:`/admin/refund/${t.id}/approve`,method:"post"});e&&(200===e.code||e.success)&&(this.$message.success("已同意并退款"),this.getList())}catch(e){}},async reject(t){try{const{value:e}=await this.$prompt("请输入驳回理由","驳回退款",{confirmButtonText:"确定",cancelButtonText:"取消",inputValidator:t=>!(!t||!t.trim()),inputErrorMessage:"请填写驳回理由"}),a=await(0,l.A)({url:`/admin/refund/${t.id}/reject`,method:"post",data:{reason:e}});a&&(200===a.code||a.success)&&(this.$message.success("已驳回"),this.getList())}catch(e){}},tagType(t){return{applied:"warning",processing:"info",completed:"success",revoked:"danger"}[t]||"info"},statusText(t){return{applied:"申请中",processing:"处理中",completed:"退款完成",revoked:"已撤回"}[t]||t},formatDate(t){return t?new Date(t.toString().replace("T"," ").replace(/-/g,"/")).toLocaleString("zh-CN"):"-"},reset(){this.query={page:1,size:10,status:""},this.getList()}}},o=i,n=a(1656),c=(0,n.A)(o,s,r,!1,null,"1d0dc10a",null),u=c.exports}}]);