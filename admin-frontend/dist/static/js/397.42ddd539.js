"use strict";(self["webpackChunkadmin_frontend"]=self["webpackChunkadmin_frontend"]||[]).push([[397],{6397:function(t,e,a){a.r(e),a.d(e,{default:function(){return h}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"teacher-certification"},[e("div",{staticClass:"filter-container"},[e("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.queryParams}},[e("el-form-item",{attrs:{label:"教师姓名"}},[e("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入教师姓名",clearable:""},model:{value:t.queryParams.teacherName,callback:function(e){t.$set(t.queryParams,"teacherName",e)},expression:"queryParams.teacherName"}})],1),e("el-form-item",{attrs:{label:"真实姓名"}},[e("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入真实姓名",clearable:""},model:{value:t.queryParams.realName,callback:function(e){t.$set(t.queryParams,"realName",e)},expression:"queryParams.realName"}})],1),e("el-form-item",{attrs:{label:"认证状态"}},[e("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"请选择状态",clearable:""},model:{value:t.queryParams.certificationStatus,callback:function(e){t.$set(t.queryParams,"certificationStatus",e)},expression:"queryParams.certificationStatus"}},[e("el-option",{attrs:{label:"待审核",value:0}}),e("el-option",{attrs:{label:"审核通过",value:1}}),e("el-option",{attrs:{label:"审核拒绝",value:2}}),e("el-option",{attrs:{label:"待面试",value:3}}),e("el-option",{attrs:{label:"面试通过",value:4}}),e("el-option",{attrs:{label:"面试不通过",value:5}})],1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.handleQuery}},[e("i",{staticClass:"el-icon-search"}),t._v(" 搜索 ")]),e("el-button",{on:{click:t.resetQuery}},[e("i",{staticClass:"el-icon-refresh"}),t._v(" 重置 ")])],1)],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.certificationList,border:""}},[e("el-table-column",{attrs:{prop:"teacherName",label:"教师姓名",width:"120"}}),e("el-table-column",{attrs:{prop:"teacherPhone",label:"手机号",width:"130"}}),e("el-table-column",{attrs:{prop:"realName",label:"真实姓名",width:"120"}}),e("el-table-column",{attrs:{prop:"genderText",label:"性别",width:"80"}}),e("el-table-column",{attrs:{prop:"graduateSchool",label:"毕业院校",width:"180","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"education",label:"学历",width:"80"}}),e("el-table-column",{attrs:{prop:"certificationStatusText",label:"认证状态",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tag",{attrs:{type:t.getStatusTagType(a.row.certificationStatus),size:"small"}},[t._v(" "+t._s(a.row.certificationStatusText)+" ")])]}}])}),e("el-table-column",{attrs:{prop:"submitTime",label:"提交时间",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.formatDate(e.row.submitTime))+" ")]}}])}),e("el-table-column",{attrs:{prop:"auditTime",label:"审核时间",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.formatDate(e.row.auditTime))+" ")]}}])}),e("el-table-column",{attrs:{label:"操作",width:"180",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.handleDetail(a.row)}}},[t._v(" 查看详情 ")]),0===a.row.certificationStatus?e("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(e){return t.handleAudit(a.row)}}},[t._v(" 审核 ")]):t._e(),3===a.row.certificationStatus?e("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.handleGrade(a.row)}}},[t._v(" 评级 ")]):t._e()]}}])})],1),e("div",{staticClass:"pagination-container"},[e("el-pagination",{attrs:{"current-page":t.queryParams.page,"page-sizes":[10,20,30,50],"page-size":t.queryParams.size,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),e("el-dialog",{attrs:{title:"认证详情",visible:t.detailDialogVisible,width:"800px","close-on-click-modal":!1},on:{"update:visible":function(e){t.detailDialogVisible=e}}},[t.currentCertification?e("div",{staticClass:"certification-detail"},[e("el-card",{staticClass:"box-card",staticStyle:{"margin-bottom":"20px"}},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",[t._v("基本信息")])]),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:8}},[e("div",{staticClass:"detail-item"},[e("span",{staticClass:"label"},[t._v("教师姓名：")]),e("span",[t._v(t._s(t.currentCertification.teacherName))])])]),e("el-col",{attrs:{span:8}},[e("div",{staticClass:"detail-item"},[e("span",{staticClass:"label"},[t._v("手机号：")]),e("span",[t._v(t._s(t.currentCertification.teacherPhone))])])]),e("el-col",{attrs:{span:8}},[e("div",{staticClass:"detail-item"},[e("span",{staticClass:"label"},[t._v("认证状态：")]),e("el-tag",{attrs:{type:t.getStatusTagType(t.currentCertification.certificationStatus)}},[t._v(" "+t._s(t.currentCertification.certificationStatusText)+" ")])],1)]),e("el-col",{attrs:{span:8}},[e("div",{staticClass:"detail-item"},[e("span",{staticClass:"label"},[t._v("真实姓名：")]),e("span",[t._v(t._s(t.currentCertification.realName))])])]),e("el-col",{attrs:{span:8}},[e("div",{staticClass:"detail-item"},[e("span",{staticClass:"label"},[t._v("性别：")]),e("span",[t._v(t._s(t.currentCertification.genderText))])])]),e("el-col",{attrs:{span:8}},[e("div",{staticClass:"detail-item"},[e("span",{staticClass:"label"},[t._v("毕业院校：")]),e("span",[t._v(t._s(t.currentCertification.graduateSchool))])])]),e("el-col",{attrs:{span:8}},[e("div",{staticClass:"detail-item"},[e("span",{staticClass:"label"},[t._v("学历：")]),e("span",[t._v(t._s(t.currentCertification.education))])])]),e("el-col",{attrs:{span:8}},[e("div",{staticClass:"detail-item"},[e("span",{staticClass:"label"},[t._v("银行卡号：")]),e("span",[t._v(t._s(t.formatBankCard(t.currentCertification.bankCard)))])])])],1)],1),e("el-card",{staticClass:"box-card",staticStyle:{"margin-bottom":"20px"}},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",[t._v("身份证件")])]),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("div",{staticClass:"cert-image"},[e("p",[t._v("身份证人像面")]),t.currentCertification.idCardFront?e("el-image",{staticStyle:{width:"300px",height:"200px"},attrs:{src:t.currentCertification.idCardFront,fit:"contain","preview-src-list":[t.currentCertification.idCardFront]}}):e("div",{staticClass:"no-image"},[t._v("暂无图片")])],1)]),e("el-col",{attrs:{span:12}},[e("div",{staticClass:"cert-image"},[e("p",[t._v("身份证国徽面")]),t.currentCertification.idCardBack?e("el-image",{staticStyle:{width:"300px",height:"200px"},attrs:{src:t.currentCertification.idCardBack,fit:"contain","preview-src-list":[t.currentCertification.idCardBack]}}):e("div",{staticClass:"no-image"},[t._v("暂无图片")])],1)])],1)],1),e("el-card",{staticClass:"box-card",staticStyle:{"margin-bottom":"20px"}},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",[t._v("学历证明")])]),e("div",{staticClass:"diploma-images"},[t._l(t.currentCertification.diplomaCerts,function(a,i){return e("div",{key:i,staticClass:"diploma-item"},[e("el-image",{staticStyle:{width:"200px",height:"150px"},attrs:{src:a,fit:"contain","preview-src-list":t.currentCertification.diplomaCerts}})],1)}),t.currentCertification.diplomaCerts&&0!==t.currentCertification.diplomaCerts.length?t._e():e("div",{staticClass:"no-image"},[t._v(" 暂无学历证明 ")])],2)]),e("el-card",{staticClass:"box-card",staticStyle:{"margin-bottom":"20px"}},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",[t._v("资格证书")])]),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("div",{staticClass:"cert-image"},[e("p",[t._v("教师资格证")]),t.currentCertification.teacherCert?e("el-image",{staticStyle:{width:"250px",height:"180px"},attrs:{src:t.currentCertification.teacherCert,fit:"contain","preview-src-list":[t.currentCertification.teacherCert]}}):e("div",{staticClass:"no-image"},[t._v("暂无图片")])],1)]),e("el-col",{attrs:{span:12}},[e("div",{staticClass:"cert-image"},[e("p",[t._v("获奖认证")]),t.currentCertification.awardCert?e("el-image",{staticStyle:{width:"250px",height:"180px"},attrs:{src:t.currentCertification.awardCert,fit:"contain","preview-src-list":[t.currentCertification.awardCert]}}):e("div",{staticClass:"no-image"},[t._v("暂无图片")])],1)])],1)],1),t.currentCertification.auditTime?e("el-card",{staticClass:"box-card"},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",[t._v("审核信息")])]),e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:8}},[e("div",{staticClass:"detail-item"},[e("span",{staticClass:"label"},[t._v("审核人：")]),e("span",[t._v(t._s(t.currentCertification.auditUserName))])])]),e("el-col",{attrs:{span:8}},[e("div",{staticClass:"detail-item"},[e("span",{staticClass:"label"},[t._v("审核时间：")]),e("span",[t._v(t._s(t.formatDate(t.currentCertification.auditTime)))])])]),e("el-col",{staticStyle:{"margin-top":"10px"},attrs:{span:24}},[e("div",{staticClass:"detail-item"},[e("span",{staticClass:"label"},[t._v("审核意见：")]),e("p",{staticStyle:{"margin-top":"5px"}},[t._v(t._s(t.currentCertification.auditReason||"无"))])])])],1)],1):t._e()],1):t._e()]),e("el-dialog",{attrs:{title:"审核认证",visible:t.auditDialogVisible,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(e){t.auditDialogVisible=e}}},[e("el-form",{ref:"auditForm",attrs:{model:t.auditForm,rules:t.auditRules,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"审核结果",prop:"certificationStatus"}},[e("el-radio-group",{model:{value:t.auditForm.certificationStatus,callback:function(e){t.$set(t.auditForm,"certificationStatus",e)},expression:"auditForm.certificationStatus"}},[e("el-radio",{attrs:{label:3}},[t._v("安排面试")]),e("el-radio",{attrs:{label:2}},[t._v("审核拒绝")])],1)],1),3===t.auditForm.certificationStatus?e("el-form-item",{attrs:{label:"面试时间",prop:"interviewTime"}},[e("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"选择面试时间"},model:{value:t.auditForm.interviewTime,callback:function(e){t.$set(t.auditForm,"interviewTime",e)},expression:"auditForm.interviewTime"}})],1):t._e(),e("el-form-item",{attrs:{label:"审核意见",prop:"auditReason"}},[e("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入审核意见"},model:{value:t.auditForm.auditReason,callback:function(e){t.$set(t.auditForm,"auditReason",e)},expression:"auditForm.auditReason"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.auditDialogVisible=!1}}},[t._v("取消")]),e("el-button",{attrs:{type:"primary",loading:t.auditLoading},on:{click:t.submitAudit}},[t._v("确定")])],1)],1),e("el-dialog",{attrs:{title:"教师等级评定",visible:t.gradeDialogVisible,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(e){t.gradeDialogVisible=e}}},[e("el-form",{ref:"gradeForm",attrs:{model:t.gradeForm,rules:t.gradeRules,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"教师等级",prop:"teacherLevel"}},[e("el-select",{staticStyle:{width:"100%"},model:{value:t.gradeForm.teacherLevel,callback:function(e){t.$set(t.gradeForm,"teacherLevel",e)},expression:"gradeForm.teacherLevel"}},[e("el-option",{attrs:{label:"初级教师",value:"junior"}}),e("el-option",{attrs:{label:"中级教师",value:"intermediate"}}),e("el-option",{attrs:{label:"高级教师",value:"senior"}}),e("el-option",{attrs:{label:"专家教师",value:"expert"}})],1)],1),e("el-form-item",{attrs:{label:"评级说明"}},[e("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入评级说明"},model:{value:t.gradeForm.gradeReason,callback:function(e){t.$set(t.gradeForm,"gradeReason",e)},expression:"gradeForm.gradeReason"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.gradeDialogVisible=!1}}},[t._v("取消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.submitGrade}},[t._v("确定")])],1)],1)],1)},r=[],s=a(6879);function l(t){return(0,s.A)({url:"/admin/teacher/certification/list",method:"get",params:t})}function o(t){return(0,s.A)({url:`/admin/teacher/certification/${t}`,method:"get"})}function n(t){return(0,s.A)({url:"/admin/teacher/certification/audit",method:"post",data:t})}function c(t){return(0,s.A)({url:"/admin/teacher/certification/grade",method:"post",data:t})}var d={name:"TeacherCertification",data(){return{loading:!1,certificationList:[],total:0,queryParams:{page:1,size:10,teacherName:"",realName:"",certificationStatus:null},detailDialogVisible:!1,currentCertification:null,auditDialogVisible:!1,auditLoading:!1,auditForm:{id:null,certificationStatus:3,auditReason:"",interviewTime:null},auditRules:{certificationStatus:[{required:!0,message:"请选择审核结果",trigger:"change"}],interviewTime:[{required:!0,message:"请选择面试时间",trigger:"change"}]},gradeDialogVisible:!1,gradeForm:{id:null,teacherLevel:"junior",gradeReason:""},gradeRules:{teacherLevel:[{required:!0,message:"请选择教师等级",trigger:"change"}]}}},created(){this.getList()},methods:{async getList(){this.loading=!0;try{const t=await l(this.queryParams);t.success?(this.certificationList=t.data.list||[],this.total=t.data.total||0):this.$message.error(t.message||"获取数据失败")}catch(t){console.error("获取认证列表失败:",t),this.$message.error("获取数据失败")}finally{this.loading=!1}},handleQuery(){this.queryParams.page=1,this.getList()},resetQuery(){this.queryParams={page:1,size:10,teacherName:"",realName:"",certificationStatus:null},this.getList()},handleSizeChange(t){this.queryParams.size=t,this.queryParams.page=1,this.getList()},handleCurrentChange(t){this.queryParams.page=t,this.getList()},async handleDetail(t){try{const e=await o(t.id);if(e.success){const t={NODE_ENV:"production",VUE_APP_API_TARGET:"https://www.xwsedumatch.cn",VUE_APP_BASE_API:"/api",VUE_APP_COMPLAINT_URL:"",VUE_APP_FILE_HOST:"https://www.xwsedumatch.cn",BASE_URL:"/"}.VUE_APP_FILE_BASE||"/api";this.currentCertification=this.transformCertification(e.data,t),this.detailDialogVisible=!0}else this.$message.error(e.message||"获取详情失败")}catch(e){console.error("获取认证详情失败:",e),this.$message.error("获取详情失败")}},handleAudit(t){this.auditForm={id:t.id,certificationStatus:3,auditReason:"",interviewTime:null},this.auditDialogVisible=!0},async submitAudit(){this.$refs.auditForm.validate(async t=>{if(t){this.auditLoading=!0;try{const t=await n(this.auditForm);t.success?(this.$message.success("审核成功"),this.auditDialogVisible=!1,this.getList()):this.$message.error(t.message||"审核失败")}catch(e){console.error("审核失败:",e),this.$message.error("审核失败")}finally{this.auditLoading=!1}}})},getStatusTagType(t){const e={0:"warning",1:"success",2:"danger",3:"info",4:"success",5:"danger"};return e[t]||"info"},transformCertification(t,e){if(!t)return null;const a=t=>{if(!t)return[];if(Array.isArray(t))return t;try{const e=JSON.parse(t);return Array.isArray(e)?e:[]}catch(e){return console.warn("解析图片列表失败:",t,e),[]}},i=t=>t?/^https?:/i.test(t)?t:`${e}${t}`:"",r={...t},s=a(t.diplomaCerts).map(i),l=a(t.teacherCerts).map(i),o=a(t.awardCerts).map(i);return r.diplomaCerts=s,r.teacherCerts=l,r.awardCerts=o,r.idCardFront=i(t.idCardFront),r.idCardBack=i(t.idCardBack),r.teacherCert=l.length?l[0]:"",r.awardCert=o.length?o[0]:"",r},formatDate(t){return t?new Date(t).toLocaleString("zh-CN"):"-"},formatBankCard(t){return t?t.replace(/(\d{4})(?=\d)/g,"$1 "):"-"},handleGrade(t){this.gradeForm={id:t.id,teacherLevel:"junior",gradeReason:""},this.gradeDialogVisible=!0},async submitGrade(){this.$refs.gradeForm.validate(async t=>{if(t)try{const t=await c(this.gradeForm);200===t.code?(this.$message.success("评级成功"),this.gradeDialogVisible=!1,this.getList()):this.$message.error(t.message||"评级失败")}catch(e){console.error("评级失败:",e),this.$message.error("评级失败")}})}}},u=d,m=a(1656),p=(0,m.A)(u,i,r,!1,null,"b12cc4ee",null),h=p.exports}}]);