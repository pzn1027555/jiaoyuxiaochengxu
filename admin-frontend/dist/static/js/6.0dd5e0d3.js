"use strict";(self["webpackChunkadmin_frontend"]=self["webpackChunkadmin_frontend"]||[]).push([[6],{8006:function(t,a,s){s.r(a),s.d(a,{default:function(){return h}});var e=function(){var t=this,a=t._self._c;return a("div",{staticClass:"dashboard-container"},[a("div",{staticClass:"data-board-section"},[a("h3",{staticClass:"section-title"},[a("i",{staticClass:"el-icon-data-line"}),t._v(" 数据看板 "),a("el-button",{attrs:{type:"text",size:"mini",loading:t.realtimeLoading},on:{click:t.refreshRealtimeData}},[a("i",{staticClass:"el-icon-refresh"}),t._v(" 刷新 ")])],1),a("el-row",{staticClass:"data-cards",attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"data-card users"},[a("div",{staticClass:"card-header"},[a("i",{staticClass:"el-icon-user"}),a("span",{staticClass:"card-title"},[t._v("今日新增用户")])]),a("div",{staticClass:"card-value"},[t._v(t._s(t.realtimeData.todayNewUsers||0))])])]),a("el-col",{attrs:{span:6}},[a("div",{staticClass:"data-card orders"},[a("div",{staticClass:"card-header"},[a("i",{staticClass:"el-icon-shopping-bag-2"}),a("span",{staticClass:"card-title"},[t._v("今日订单数")])]),a("div",{staticClass:"card-value"},[t._v(t._s(t.realtimeData.todayOrders||0))])])]),a("el-col",{attrs:{span:6}},[a("div",{staticClass:"data-card revenue"},[a("div",{staticClass:"card-header"},[a("i",{staticClass:"el-icon-coin"}),a("span",{staticClass:"card-title"},[t._v("今日收入")])]),a("div",{staticClass:"card-value"},[t._v("¥"+t._s(t.formatNumber(t.realtimeData.todayRevenue)||0))])])]),a("el-col",{attrs:{span:6}},[a("div",{staticClass:"data-card total-users"},[a("div",{staticClass:"card-header"},[a("i",{staticClass:"el-icon-user-solid"}),a("span",{staticClass:"card-title"},[t._v("总用户数")])]),a("div",{staticClass:"card-value"},[t._v(t._s(t.formatNumber(t.statistics.totalUsers)||0))])])])],1)],1),a("div",{staticClass:"analysis-section"},[t._m(0),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"analysis-card"},[a("h4",{staticClass:"analysis-title"},[a("i",{staticClass:"el-icon-map-location"}),t._v(" 城市渗透率分析 ")]),a("div",{staticClass:"analysis-content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.analysisLoading,expression:"analysisLoading"}],staticClass:"penetration-table",attrs:{data:t.cityPenetration,stripe:"","empty-text":"暂无数据"}},[a("el-table-column",{attrs:{prop:"city",label:"城市",width:"200"}}),a("el-table-column",{attrs:{prop:"userCount",label:"用户数",width:"120"}}),a("el-table-column",{attrs:{prop:"penetrationRate",label:"渗透率(%)"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" "+t._s(a.row.penetrationRate?a.row.penetrationRate.toFixed(2):"0.00")+"% ")]}}])})],1)],1)])]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"analysis-card"},[a("h4",{staticClass:"analysis-title"},[a("i",{staticClass:"el-icon-trend-charts"}),t._v(" 用户单价趋势预测 ")]),a("div",{staticClass:"analysis-content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.analysisLoading,expression:"analysisLoading"}],staticClass:"trend-table",attrs:{data:t.orderAmountTrend,stripe:"","empty-text":"暂无数据"}},[a("el-table-column",{attrs:{prop:"date",label:"日期",width:"200"}}),a("el-table-column",{attrs:{prop:"avgOrderAmount",label:"平均单价(元)",width:"120"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v(" "+t._s(t.formatNumber(a.row.avgOrderAmount))+" ")]}}])}),a("el-table-column",{attrs:{prop:"orderCount",label:"订单数"}})],1)],1)])])],1)],1),a("div",{staticClass:"panel-section"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"panel-card"},[a("h3",{staticClass:"panel-title"},[a("i",{staticClass:"el-icon-user-solid"}),t._v(" 教师审核面板 "),a("el-badge",{staticClass:"badge",attrs:{value:t.teacherAuditData.pendingAuditCount,max:99}})],1),a("div",{staticClass:"panel-stats"},[a("div",{staticClass:"stat-item"},[a("span",{staticClass:"stat-value"},[t._v(t._s(t.teacherAuditData.pendingAuditCount||0))]),a("span",{staticClass:"stat-label"},[t._v("待审核")])]),a("div",{staticClass:"stat-item"},[a("span",{staticClass:"stat-value"},[t._v(t._s(t.teacherAuditData.riskTeacherCount||0))]),a("span",{staticClass:"stat-label"},[t._v("风险教师")])]),a("div",{staticClass:"stat-item"},[a("span",{staticClass:"stat-value"},[t._v(t._s(t.teacherAuditData.newApplications||0))]),a("span",{staticClass:"stat-label"},[t._v("今日新申请")])]),a("div",{staticClass:"stat-item"},[a("span",{staticClass:"stat-value"},[t._v(t._s(t.teacherAuditData.avgProcessTime||0)+"天")]),a("span",{staticClass:"stat-label"},[t._v("平均处理时间")])])]),a("div",{staticClass:"panel-list"},[a("div",{staticClass:"list-header"},[a("span",[t._v("待审核教师")]),a("el-button",{attrs:{type:"text",size:"mini"}},[t._v("查看全部")])],1),a("div",{staticClass:"list-content"},t._l(t.teacherAuditData.pendingTeachers,function(s){return a("div",{key:s.id,staticClass:"list-item"},[a("div",{staticClass:"item-info"},[a("div",{staticClass:"item-name"},[t._v(t._s(s.name))]),a("div",{staticClass:"item-desc"},[t._v(t._s(s.subject)+" · "+t._s(t.formatTime(s.applyTime)))])]),a("div",{staticClass:"item-actions"},[a("el-tag",{attrs:{type:"高"===s.urgency?"danger":"warning",size:"mini"}},[t._v(" "+t._s(s.urgency)+" ")])],1)])}),0)])])]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"panel-card"},[a("h3",{staticClass:"panel-title"},[a("i",{staticClass:"el-icon-warning"}),t._v(" 投诉处理面板 "),a("el-badge",{staticClass:"badge",attrs:{value:t.complaintData.pendingComplaints,max:99}})],1),a("div",{staticClass:"panel-stats"},[a("div",{staticClass:"stat-item"},[a("span",{staticClass:"stat-value"},[t._v(t._s(t.complaintData.pendingComplaints||0))]),a("span",{staticClass:"stat-label"},[t._v("待处理")])]),a("div",{staticClass:"stat-item"},[a("span",{staticClass:"stat-value"},[t._v(t._s(t.complaintData.totalComplaints||0))]),a("span",{staticClass:"stat-label"},[t._v("总投诉")])]),a("div",{staticClass:"stat-item"},[a("span",{staticClass:"stat-value"},[t._v(t._s(t.complaintData.todayComplaints||0))]),a("span",{staticClass:"stat-label"},[t._v("今日新增")])]),a("div",{staticClass:"stat-item"},[a("span",{staticClass:"stat-value"},[t._v(t._s(t.complaintData.avgResponseTime?0-t.complaintData.avgResponseTime:0)+"h")]),a("span",{staticClass:"stat-label"},[t._v("平均响应时间")])])]),a("div",{staticClass:"panel-list"},[a("div",{staticClass:"list-header"},[a("span",[t._v("最近投诉")]),a("el-button",{attrs:{type:"text",size:"mini"}},[t._v("查看全部")])],1),a("div",{staticClass:"list-content"},t._l(t.complaintData.recentComplaints,function(s){return a("div",{key:s.id,staticClass:"list-item"},[a("div",{staticClass:"item-info"},[a("div",{staticClass:"item-name"},[t._v(t._s(s.studentName)+" → "+t._s(s.teacherName))]),a("div",{staticClass:"item-desc"},[t._v(t._s(s.type)+" · "+t._s(t.formatTime(s.createTime)))])]),a("div",{staticClass:"item-actions"},[a("el-tag",{attrs:{type:"待处理"===s.status?"warning":"success",size:"mini"}},[t._v(" "+t._s(s.status)+" ")])],1)])}),0)])])])],1)],1)])},i=[function(){var t=this,a=t._self._c;return a("h3",{staticClass:"section-title"},[a("i",{staticClass:"el-icon-s-data"}),t._v(" 用户数据汇总分析 ")])}],l=s(6879);function n(){return(0,l.A)({url:"/dashboard/statistics",method:"get"})}function r(){return(0,l.A)({url:"/dashboard/realtime",method:"get"})}function c(t,a){return(0,l.A)({url:"/dashboard/trend/order-amount",method:"get",params:{startDate:t,endDate:a}})}function d(){return(0,l.A)({url:"/dashboard/analysis/city-penetration",method:"get"})}function o(){return(0,l.A)({url:"/dashboard/panel/teacher-audit",method:"get"})}function m(){return(0,l.A)({url:"/dashboard/panel/complaint",method:"get"})}var v={name:"Dashboard",data(){return{loading:!1,realtimeLoading:!1,analysisLoading:!1,statistics:{},realtimeData:{},teacherAuditData:{},complaintData:{},cityPenetration:[],orderAmountTrend:[],realtimeTimer:null}},mounted(){this.loadAllData(),this.startRealtimeUpdate()},beforeDestroy(){this.realtimeTimer&&clearInterval(this.realtimeTimer)},methods:{async loadAllData(){this.loading=!0;try{await Promise.all([this.loadStatistics(),this.loadRealtimeData(),this.loadPanelData(),this.loadAnalysisData()])}catch(t){console.error("加载数据失败",t)}finally{this.loading=!1}},async loadStatistics(){const t=await n();200===t.code&&(this.statistics=t.data)},async loadRealtimeData(){const t=await r();200===t.code&&(this.realtimeData=t.data)},async loadPanelData(){const[t,a]=await Promise.all([o(),m()]);200===t.code&&(this.teacherAuditData=t.data),200===a.code&&(this.complaintData=a.data)},async loadAnalysisData(){this.analysisLoading=!0;try{const t=await d();200===t.code&&(this.cityPenetration=Array.isArray(t.data.cities)?t.data.cities:[]);const a=(new Date).toISOString().split("T")[0],s=new Date(Date.now()-2592e6).toISOString().split("T")[0],e=await c(s,a);200===e.code&&(this.orderAmountTrend=Array.isArray(e.data.trend)?e.data.trend:[])}catch(t){console.error("加载分析数据失败",t),this.cityPenetration=[],this.orderAmountTrend=[]}finally{this.analysisLoading=!1}},async refreshRealtimeData(){this.realtimeLoading=!0;try{await this.loadRealtimeData()}finally{this.realtimeLoading=!1}},startRealtimeUpdate(){this.realtimeTimer=setInterval(()=>{this.loadRealtimeData()},3e4)},formatNumber(t){return t?t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"0"},formatTime(t){if(!t)return"-";const a=new Date(t),s=new Date,e=s-a;return e<6e4?"刚刚":e<36e5?Math.floor(e/6e4)+"分钟前":e<864e5?Math.floor(e/36e5)+"小时前":a.toLocaleDateString()}}},u=v,p=s(1656),C=(0,p.A)(u,e,i,!1,null,"029e1d02",null),h=C.exports}}]);