<view class="page">
  <custom-header title="学习计划" show-back="{{true}}" bind:headerReady="onHeaderReady" />

  <view class="content" style="padding-top: {{headerHeight}}px;">
    <!-- 顶部孩子横向选择 -->
    <scroll-view class="children-bar" scroll-x="true" show-scrollbar="false">
      <view class="children-track">
        <view class="child {{currentStudentId===item.studentId?'active':''}}" wx:for="{{students}}" wx:key="studentId" data-id="{{item.studentId}}" bindtap="onPickStudent">
          <image class="avatar" src="{{item.studentAvatar || '/images/default-avatar.png'}}" mode="aspectFill" />
          <text class="name">{{item.studentName}}</text>
        </view>
      </view>
    </scroll-view>

    <!-- 月历（同 schedule-confirm） -->
    <view class="calendar-section">
      <view class="calendar-header">
        <text class="ms-btn" bindtap="prevMonth">‹</text>
        <text class="ms-title">{{year}}年{{month}}月</text>
        <text class="ms-btn" bindtap="nextMonth">›</text>
      </view>
      <view class="ms-week">
        <text wx:for="{{['一','二','三','四','五','六','日']}}" wx:key="*this" class="ms-wd">{{item}}</text>
      </view>
      <view class="ms-grid">
        <view class="ms-cell" wx:for="{{days}}" wx:key="index" data-index="{{index}}" bindtap="onSelectDay">
          <text class="ms-date {{item.isToday ? 'today' : ''}} {{item.selected ? 'selected' : ''}}">{{item.date}}</text>
          <view class="ms-dot {{item.hasCourse ? 'on' : ''}}"></view>
        </view>
      </view>
    </view>

    <!-- 日期 + 课程信息列表（同 schedule-confirm） -->
    <view class="schedule-list">
      <view class="schedule-title"><text class="bar"></text>{{selectedDate}}</view>
      <block wx:if="{{items && items.length}}">
        <view class="schedule-items">
          <view class="schedule-item" wx:for="{{items}}" wx:key="id">
            <view style="width: 8rpx; background:#54B247; height: 100%; margin-right: 20rpx; border-radius: 4rpx;"></view>
            <view class="schedule-info">
              <view class="schedule-title-text" style="color:#0F0F14;">{{item.startTimeText}} ~ {{item.endTimeText}}</view>
              <view class="detail-row">
                <text style="color:#43434D; font-size:28rpx;">{{item.title}}</text>
                <text style="color:#0F0F14; font-size:28rpx;">第{{item.lessonNo ? item.lessonNo : item.lessonNumber}}课 <text style="color:#9898A6;">/ 共{{item.totalLessons}}节课</text></text>
              </view>
              <view style="color:#9898A6; font-size:24rpx;">{{item.remark ? item.remark : item.intro}}</view>
            </view>
          </view>
        </view>
      </block>
      <view class="empty" wx:else>当天暂无课程</view>
    </view>
  </view>
</view>


