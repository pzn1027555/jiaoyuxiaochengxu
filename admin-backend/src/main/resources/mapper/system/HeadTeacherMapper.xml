<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.education.admin.modules.system.mapper.HeadTeacherMapper">

  <select id="findEnabledOne" resultType="map">
    SELECT id, name, phone, wechat_qr_url AS wechatQrUrl, status
    FROM head_teacher
    WHERE status = 1
    ORDER BY update_time DESC
    LIMIT 1
  </select>

  <select id="findById" resultType="map">
    SELECT id, name, phone, wechat_qr_url AS wechatQrUrl, remark, status
    FROM head_teacher WHERE id=#{id}
  </select>

  <select id="findRandomEnabled" resultType="map">
    SELECT id, name, phone, wechat_qr_url AS wechatQrUrl, remark, status
    FROM head_teacher WHERE status=1
    ORDER BY RAND() LIMIT 1
  </select>

  <select id="findRandomAny" resultType="map">
    SELECT id, name, phone, wechat_qr_url AS wechatQrUrl, remark, status
    FROM head_teacher
    ORDER BY RAND() LIMIT 1
  </select>

  <select id="listAll" resultType="map">
    SELECT id, name, phone, wechat_qr_url AS wechatQrUrl, remark, status, create_time AS createTime, update_time AS updateTime
    FROM head_teacher
    ORDER BY update_time DESC
  </select>

  <update id="disableAll">
    UPDATE head_teacher SET status = 0 WHERE status = 1
  </update>

  <insert id="insert" parameterType="map" useGeneratedKeys="true" keyProperty="id">
    INSERT INTO head_teacher(name, phone, wechat_qr_url, remark, status, create_time, update_time)
    VALUES(#{name}, #{phone}, #{wechatQrUrl}, #{remark}, COALESCE(#{status},1), NOW(), NOW())
  </insert>

  <update id="update" parameterType="map">
    UPDATE head_teacher
    SET name=#{name}, phone=#{phone}, wechat_qr_url=#{wechatQrUrl}, remark=#{remark}, status=COALESCE(#{status}, status), update_time=NOW()
    WHERE id=#{id}
  </update>

  <update id="updateStatus">
    UPDATE head_teacher SET status=#{status}, update_time=NOW() WHERE id=#{id}
  </update>

  <delete id="deleteById">
    DELETE FROM head_teacher WHERE id=#{id}
  </delete>

</mapper>


